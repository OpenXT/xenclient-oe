diff --git a/rules/merge.sh b/rules/merge.sh
index 8dfde55..5f2c0b4 100755
--- a/rules/merge.sh
+++ b/rules/merge.sh
@@ -1,5 +1,6 @@
 #!/bin/bash
 
+INDIR=`dirname $0`
 DEST=$1
 shift
 
@@ -11,12 +12,14 @@ basename=`basename $0`
 echo "// DO NOT EDIT THIS FILE - IT WAS AUTOGENERATED BY $basename FROM rules/*.part" >$DEST
 
 for i in $*; do
-  if [ "$i" == "$HDR" ] || [ "$i" == "HDR" ]; then
+  if [ "$i" = "$HDR" ] || [ "$i" = "HDR" ]; then
     echo >> $DEST;
     read hdr
     echo "$hdr" >> $DEST
+  elif test -f $i; then
+    cat $i >> $DEST || exit 1
   else
-    cat $i >> $DEST;
+    cat $INDIR/$i >> $DEST || exit 1
   fi
 done < $HDR
 
